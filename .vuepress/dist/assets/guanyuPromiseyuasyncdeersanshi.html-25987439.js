import{_ as p,r as e,o,c,b as n,d as s,e as t,a as i}from"./app-ec29cce2.js";const l="/js/await.png",u="/js/await2.png",r={},k={href:"https://es6.ruanyifeng.com/#docs/async",target:"_blank",rel:"noopener noreferrer"},d={href:"https://segmentfault.com/a/1190000007535316",target:"_blank",rel:"noopener noreferrer"},m=n("p",null,"ç¬¬ä¸€æ¬¡å†™æ–‡ç« ,å¯èƒ½ä¼šæœ‰è¯­å¥ä¸é€šé¡ºæˆ–è€…æœ‰äº›ç†è§£é”™è¯¯çš„åœ°æ–¹,ä¹Ÿè¯·å¤šå¤šæŒ‡æ­£,å¤šå¤šæ‰¹è¯„ ğŸ˜„",-1),v=n("h3",{id:"_1-å…³äºåŒæ­¥ä¸å¼‚æ­¥",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#_1-å…³äºåŒæ­¥ä¸å¼‚æ­¥","aria-hidden":"true"},"#"),s(" 1.å…³äºåŒæ­¥ä¸å¼‚æ­¥")],-1),b={href:"http://www.ruanyifeng.com/blog/2012/12/asynchronous%EF%BC%BFjavascript.html",target:"_blank",rel:"noopener noreferrer"},y=i(`<h2 id="_2-promise" tabindex="-1"><a class="header-anchor" href="#_2-promise" aria-hidden="true">#</a> 2.Promise</h2><p>ç¬¬ä¸€æ¬¡æ¥è§¦ Promise æ—¶æ˜¯å»å¹´å­¦ Vue çš„æ—¶ç”¨åˆ°çš„ Axios åº“,é‡Œé¢çš„æ–¹æ³•å°è£…å¥½äº†ç›´æ¥ç”¨çš„æ—¶å€™å°±æ˜¯ä¸‹é¢è¿™ç§æ–¹æ³•,åæ¥åœ¨è¡¥ä¹ åŸºç¡€ä»¥åŠ ES6 æ˜¯æ‰çŸ¥é“è¿™åŸæ¥æ˜¯ç”¨ Promise å°è£…çš„,ä½†æ˜¯ç¢äºè„‘å­ç¬¨æ²¡æ€ä¹ˆç†è§£,å°±è¿˜æ˜¯åªæ˜¯ä¼šç”¨,åˆ°å‰æ®µæ—¶é—´åœ¨çœ‹çš„æ—¶å€™æœ‰é‚£ä¹ˆä¸€ç‚¹ç‚¹ç†è§£äº†.</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
services
    <span class="token punctuation">.</span><span class="token function">getinfo</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Promise æ˜¯å¼‚æ­¥ç¼–ç¨‹çš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆ,å®ƒæœ‰ä¸‰ä¸ªçŠ¶æ€,<code>pending</code>ï¼ˆæ­£åœ¨è¿›è¡Œï¼‰ã€<code>fulfilled</code>ï¼ˆæ‰§è¡ŒæˆåŠŸï¼‰å’Œ<code>rejected</code>ï¼ˆæ‰§è¡Œå¤±è´¥),è€Œä¸”åªæœ‰ä¸¤ç§çŠ¶æ€:A:æ­£åœ¨è¿›è¡Œ==&gt;æ‰§è¡ŒæˆåŠŸ B:æ­£åœ¨è¿›è¡Œ==&gt;æ‰§è¡Œå¤±è´¥ä¸”çŠ¶æ€ä¸€æ—¦å‘ç”Ÿå˜åŒ–,å°±ä¸ä¼šå†ç»§ç»­å˜äº†,æˆåŠŸå°±æ˜¯æˆäº†,å¤±è´¥å°±æ˜¯å¤±è´¥äº†,ä¸ä¼šå†å»å‘ç”Ÿå˜åŒ–,è¿™ç§ç»“æœä¼šä¸€ç›´æŒç»­åˆ°ä»»åŠ¡ç»“æŸ.è€Œä¸”åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ˜¯æ— æ³•å–æ¶ˆçš„.ç”¨æ³•ä¸Š Promise æ˜¯ä¸€ä¸ªæ„é€ å‡½æ•°,å¯ä»¥ç”¨<code>new</code>å…³é”®å­—æ¥åˆ›å»ºä¸€ä¸ª Promise å¯¹è±¡,å®ƒæ¥å—ä¸¤ä¸ªå‡½æ•°å‚æ•°,åˆ†åˆ«æ˜¯<code>resolve</code>å’Œ<code>reject</code>,</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> myPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//æ¥å—ä¸¤ä¸ªå‚æ•° resolve, reject</span>
  <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// æ‰§è¡Œä¸€ä¸ªå¼‚æ­¥æ“ä½œ</span>
    num <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span> <span class="token comment">// ç”Ÿæˆä¸€ä¸ªéšæœºæ•°</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token comment">// å¦‚æœç¬¦åˆæ¡ä»¶,å°±å°†Promiseçš„çŠ¶æ€ä»æ­£åœ¨æ‰§è¡Œå˜ä¸ºæ‰§è¡ŒæˆåŠŸ</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token function">reject</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token comment">// å¦‚æœä¸ç¬¦åˆæ¡ä»¶å°±ä¼šå°†çŠ¶æ€ç”±æ­£åœ¨æ‰§è¡Œå˜ä¸ºæ‰§è¡Œå¤±è´¥</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
myPromise
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// thenç”¨äºä¸ºPromiseå®ä¾‹æ·»åŠ çŠ¶æ€æ”¹å˜æ—¶çš„å›è°ƒ</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// catchç”¨äºæŒ‡å®šå‘ç”Ÿé”™è¯¯æ—¶çš„å›è°ƒ</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ¢å¥è¯è¯´å°±æ˜¯æ‰§è¡ŒæˆåŠŸå°±åœ¨æ‰§è¡Œ then æ–¹æ³•,æ‰§è¡Œå¤±è´¥å°±å»æ‰§è¡Œ catch æ–¹æ³•</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> myPromise <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> num <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token function">reject</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
myPromise
  <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// æ³¨æ„!!</span>
<span class="token comment">//æ‰§è¡Œç»“æœæ˜¯</span>
<span class="token comment">//1</span>
<span class="token comment">//7.696298823399228</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿™é‡Œçš„ myPromise åˆ›å»ºå®Œåç«‹å³æ‰§è¡Œ,ä½†æ˜¯å› ä¸ºæ˜¯å¼‚æ­¥çš„, <code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°å°†åœ¨å½“å‰è„šæœ¬æ‰€æœ‰åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œåæ‰ä¼šæ‰§è¡Œ,æ‰€ä»¥æ‰ä¼šæœ€åè¾“å‡ºéšæœºæ•°åœ¨ç½‘é¡µçš„å›¾ç‰‡åŠ è½½æ—¶,æˆ‘ä»¬å¾€å¾€ç”¨çš„éƒ½æ˜¯å¼‚æ­¥çš„,åœ¨æ‰§è¡Œ JS æ—¶ä¼šå»å‘é€è¯·æ±‚,ç­‰åˆ°ä¸»çº¿ç¨‹æ‰§è¡Œå®Œäº†,å›¾ç‰‡ä¹Ÿè¯·æ±‚å®Œäº†é‚£ä¹ˆå›¾ç‰‡å°±ä¼šæ˜¾ç¤ºäº†.æˆ‘å¯¹<code>Promise</code>çš„ç†è§£çš„å¯èƒ½ä¸æ˜¯ç‰¹åˆ«çš„æ·±,æ‰€ä»¥è¯·è§è°….</p><p>Promise çš„ç¼ºç‚¹</p><ol><li>æ— æ³•å–æ¶ˆ<code>Promise</code>,ä¸€æ—¦æ–°å»ºå®ƒå°±ä¼šç«‹å³æ‰§è¡Œ,æ— æ³•ä¸­é€”å–æ¶ˆ</li><li>å¦‚æœä¸è®¾ç½®å›è°ƒå‡½æ•°,<code>Promise</code>å†…éƒ¨æŠ›å‡ºçš„é”™è¯¯,ä¸ä¼šååº”åˆ°å¤–éƒ¨</li><li>å½“å¤„äº<code>Pending</code>çŠ¶æ€æ—¶,æ— æ³•å¾—çŸ¥ç›®å‰è¿›å±•åˆ°å“ªä¸€ä¸ªé˜¶æ®µï¼ˆåˆšåˆšå¼€å§‹è¿˜æ˜¯å³å°†å®Œæˆï¼‰</li></ol><h2 id="_3-async-ä¸-await" tabindex="-1"><a class="header-anchor" href="#_3-async-ä¸-await" aria-hidden="true">#</a> 3.async ä¸ await</h2><p>async å…¶å®å°±æ˜¯å¼‚æ­¥(asynchronous)</p><blockquote><p><code>async</code>å‡½æ•°è¿”å›ä¸€ä¸ª Promise å¯¹è±¡,å¯ä»¥ä½¿ç”¨<code>then</code>æ–¹æ³•æ·»åŠ å›è°ƒå‡½æ•° ï¼ˆå®ƒå°±æ˜¯ Generator å‡½æ•°çš„è¯­æ³•ç³–ï¼‰ å½“å‡½æ•°æ‰§è¡Œçš„æ—¶å€™,ä¸€æ—¦é‡åˆ°<code>await</code>å°±ä¼šå…ˆè¿”å›,ç­‰åˆ°å¼‚æ­¥æ“ä½œå®Œæˆ,å†æ¥ç€æ‰§è¡Œå‡½æ•°ä½“å†…åé¢çš„è¯­å¥</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token string">&#39;helloworld&#39;</span>
  <span class="token keyword">return</span> result
<span class="token punctuation">}</span>
<span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>è¿è¡Œç»“æœ:<img src="`+l+`" alt="image.png">å¯ä»¥å‘ç°,<code>async</code>å‡½æ•°è¿”å›çš„æ˜¯ä¸€ä¸ª Promise å¯¹è±¡,è€Œä¸” async å‡½æ•°ä¸­çš„ return çš„è¿”å›å€¼å¯ä»¥åšä¸º Promise ä¸­ then æ–¹æ³•çš„å›è°ƒçš„å‚æ•°,å¦‚æœæŠ›å‡ºäº†å¼‚å¸¸,ä¹Ÿå¯ç”¨ catch æ–¹æ³•æ¥å¤„ç†,ä¸”åªæœ‰<code>async</code>å‡½æ•°å†…éƒ¨çš„å¼‚æ­¥æ“ä½œæ‰§è¡Œå®Œ,æ‰ä¼šæ‰§è¡Œ<code>then</code>æ–¹æ³•æŒ‡å®šçš„å›è°ƒå‡½æ•°.æ—¢ç„¶ async è¿”å›äº†ä¸€ä¸ª Promise å¯¹è±¡,é‚£ä¹ˆ await çš„ä½œç”¨æ˜¯ä»€ä¹ˆå‘¢?æ­£å¸¸æƒ…å†µä¸‹,<code>await</code>å‘½ä»¤åé¢æ˜¯ä¸€ä¸ª Promise å¯¹è±¡,è¿”å›è¯¥å¯¹è±¡çš„ç»“æœ.å¦‚æœä¸æ˜¯ Promise å¯¹è±¡,å°±ç›´æ¥è¿”å›å¯¹åº”çš„å€¼.</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token string">&#39;tom&#39;</span>
<span class="token punctuation">}</span>
fun<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">p</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// tom</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>await åé¢çš„å€¼å¹¶ä¸ä¸€å®šæ˜¯ä¸€ä¸ª Promise å¯¹è±¡,ä¹Ÿå°±æ˜¯è¯´,å¦‚æœ await åé¢çš„ä¸æ˜¯ä¸€ä¸ª Promise å¯¹è±¡,é‚£ä¹ˆè¿™ä¸ªå€¼å°±æ˜¯è¦&quot;ç­‰å¾…&quot;çš„å¤„ç†ç»“æœåŠ äº† await ä¹‹å,await åé¢çš„è¯­å¥éƒ½ä¼šå˜æˆåŒæ­¥çš„,æŒ‰ç…§é¡ºåºæ¥æ‰§è¡Œè¯­å¥,</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">myPromise</span><span class="token punctuation">(</span><span class="token parameter">num</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">myPromise</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">myPromise</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">myPromise</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;is end&#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">//1,2,3</span>
<span class="token comment">//is end</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½†æ˜¯è¿˜æœ‰ä¸€ç‚¹è¦æ³¨æ„æ˜¯åœ¨ await åé¢çš„å¼‚æ­¥è¯­å¥å¦‚æœæŠ›å‡ºå¼‚å¸¸,å°±ä¼šæ—¶æ•´ä¸ªå‡½æ•°ä¸­æ–­æ‰§è¡Œ</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">//æŠŠä¸Šé¢çš„ä»£ç è¿›è¡Œä¿®æ”¹</span>
<span class="token keyword">const</span> <span class="token function-variable function">myPromis</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      num <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&gt;</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token function">reject</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">myPromis</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;is end &#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œç»“æœ:<img src="`+u+`" alt="image.png">ç»“æœæ˜¯ 3.75 å°äº 5,æ‰§è¡Œ reject,æŠ›å‡ºå¼‚å¸¸,ä½†æ˜¯å¯ä»¥ç”¨ try...catch...æ¥æ”¹å†™<code>fun()</code></p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fun</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    a <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">myPromis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// å¤§äº5æ‰§è¡Œtryè¯­å¥</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// å°äºäº”æŠ›å‡ºå¼‚å¸¸æ‰§è¡Œcatchè¯­å¥</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    a <span class="token operator">=</span> <span class="token number">100</span>
  <span class="token punctuation">}</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;is end &#39;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ€»çš„æ¥è¯´ ssync ä¸ await å°±æ˜¯å¯ä»¥ç®€åŒ– Promise,ä½¿å…¶æ›´ç›´è§‚çš„ä½†è¦æ³¨æ„ async ä¸ await çš„ä½¿ç”¨:</p><ul><li>await å…³é”®å­—å¿…é¡»ä½äº async å‡½æ•°å†…éƒ¨</li><li>ä¸èƒ½åœ¨æ™®é€šç®­å¤´å‡½æ•°ä¸­ä½¿ç”¨ await å…³é”®å­—,éœ€è¦åœ¨ç®­å¤´å‡½æ•°å‰é¢æ·»åŠ  async</li></ul>`,24);function f(g,w){const a=e("ExternalLinkIcon");return o(),c("div",null,[n("blockquote",null,[n("blockquote",null,[n("p",null,[s("æœ€è¿‘å…³äº Promise çœ‹äº†å¥½ä¸€äº›æ–‡ç« æ¥é˜è¿°ç”¨é€”,å†åŠ ä¸Šå¼‚æ­¥ç¼–ç¨‹å’Œ async ä¸ await çš„ç”¨æ³•å¼„çš„å±å®å¤´å¤§,ä½†æ˜¯çœ‹äº†å¥½å‡ éä¹‹åæ„Ÿè§‰æœ‰ç‚¹ä¸Šé“äº†,ç„¶åæŠ“ç´§å§æˆ‘çŸ¥é“çš„ç†è§£çš„è®°å½•ä¸‹æ¥äº†,æˆ‘åœ¨è¿™é‡Œåªæ˜¯é˜è¿°æˆ‘å¯¹ Promise å’Œ async çš„ä¸€äº›ç†è§£,å…³äº promise å’Œ async çš„æ›´å¤šç»†èŠ‚å¯ä»¥å»æŸ¥çœ‹é˜®ä¸€å³°è€å¸ˆçš„"),n("a",k,[s("ES6 å…¥é—¨"),t(a)]),s(",æˆ–è€…è¾¹åŸè€å¸ˆçš„"),n("a",d,[s("ç†è§£ JavaScript çš„ async/await"),t(a)])])])]),m,v,n("p",null,[s("js æ˜¯å•çº¿ç¨‹çš„,æ‰§è¡Œæ—¶åªèƒ½ç­‰å¾…å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•æ‰ä¼šæ‰§è¡Œä¸‹ä¸€ä¸ª,ä½†å½“å‰ä¸€ä¸ªä»»åŠ¡è€—æ—¶è¿‡é•¿æ—¶,å°±ä¼šå‘ç”Ÿé˜»å¡,å¦‚æœæ‰€æœ‰ä»»åŠ¡éƒ½æ˜¯åŒæ­¥æ‰§è¡Œçš„è¯,å°±å¯èƒ½ä¼šé€ æˆæµè§ˆå™¨å¡é¡¿ç­‰æƒ…å†µ,æ‰€ä»¥é‚£äº›æ‰§è¡Œæ—¶é—´å¾ˆé•¿çš„ä»»åŠ¡éƒ½åº”è¯¥å¼‚æ­¥æ¥å¤„ç†.å…³äºå¼‚æ­¥æ¨¡å¼ç¼–ç¨‹çš„å®ç°æ–¹å¼å¯ä»¥å…·ä½“å»å‚è€ƒé˜®ä¸€å³°è€å¸ˆçš„"),n("a",b,[s("Javascript å¼‚æ­¥ç¼–ç¨‹çš„ 4 ç§æ–¹æ³•"),t(a)])]),y])}const P=p(r,[["render",f],["__file","guanyuPromiseyuasyncdeersanshi.html.vue"]]);export{P as default};
